<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>NextRail | Cadastro Usuários </title>


  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/menu.css">
  <link rel="stylesheet" href="./css/admStyle.css">
  <link rel="icon" href="./assets/icon/nextrail-logo.jpg">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <!-- Menu lateral -->
  <div class="menu">
    <ul class="link-items">
      <div class="logo-container">
        <img src="./assets/icon/logo-SFroxo.png" alt="Logo NextRail" class="logo-menu">
      </div>

      <li class="link-item">
        <a href="usuarios.html" class="link">
          <ion-icon name="person"></ion-icon>
          <span style="--i: 2">Usuários</span>
        </a>
      </li>

      <li class="link-item active">
        <a href="cadastroUsuario.html" class="link">
          <ion-icon name="create"></ion-icon>
          <span style="--i: 1">Cadastro Usuários</span>
        </a>
      </li>





      <li class="link-item">
        <a href="login.html" class="link">
          <ion-icon name="log-out-outline"></ion-icon>
          <span style="--i: 4">Sair</span>
        </a>
      </li>
    </ul>
  </div>

  <!-- Menu hamburger -->
  <div class="hamburger" id="hamburger">
    <span></span>
    <span></span>
    <span></span>
  </div>

  <main class="fundo-escuro">
    <div class="container-pagina">
      <div class="container">
        <div class="card card-cadastro">
          <h2>Cadastrar Usuário</h2>
          <div class="formulario">
            <div class="campo">
              <span>Nome:</span>
              <input id="nome_input" type="text" placeholder="">
            </div>
            <div class="campo">
              <span>CPF:</span>
              <input type="text" id="cpf_input" required maxlength="14">
            </div>
            <div class="campo">
              <span>Cargo:</span>
              <select name="" id="cargo_input">
                <option value="">Escolha uma opção</option>
              </select>
            </div>
            <div class="campo">
              <span>E-mail:</span>
              <input id="email_input" type="text" placeholder="@gmail.com">
            </div>
            <div class="campo">
              <span>Senha:</span>
              <input id="senha_input" type="password" placeholder="******">
            </div>
            <button class="botao" onclick="cadastrar()">Cadastrar</button>
          </div>

          <div id="div_erros_cadastro"></div>
        </div>
      </div>
    </div>
  </main>

  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
  <script src="./js/script.js"></script>
</body>

</html>

<script>
  function mascaraCPF(value) {
    return value
      .replace(/\D/g, "")
      .replace(/(\d{3})(\d)/, "$1.$2")
      .replace(/(\d{3})(\d)/, "$1.$2")
      .replace(/(\d{3})(\d{1,2})$/, "$1-$2");
  }

  document.getElementById("cpf_input").addEventListener("input", function () {
    this.value = mascaraCPF(this.value);
  });

  const selectCargo = document.getElementById("cargo_input");

  document.addEventListener("DOMContentLoaded", function() {
  const selectCargo = document.getElementById("cargo_input");

  fetch("/usuarios/procurarCargos", { method: "POST", headers: { "Content-Type": "application/json" } })
    .then(res => {
      if (!res.ok) throw "Erro na requisição de cargos!";
      return res.json();
    })
    .then(dados => {
      console.log("Cargos:", dados);
      dados.forEach(cargo => {
        if(cargo.id!=1){
        selectCargo.add(new Option(cargo.nome, cargo.id));  
        }
        
      });
    })
    .catch(erro => console.log("#ERRO cargos:", erro));

});
</script>